# SOC-126: NestJS v11 Coordinated Upgrade

| Field | Value |
|-------|-------|
| Epic | E01-dependency-upgrades |
| Project | P4-maintenance |
| Status | backlog |
| Priority | High |
| Story Points | 8 |
| Created | 2025-12-17 |
| Completed | - |

## Description

Upgrade all NestJS packages from v10 to v11 in a single coordinated PR. This replaces the individual Dependabot PRs (#11, #13, #20, #21, #23) which were closed because they only upgraded single packages, causing peer dependency conflicts.

## Acceptance Criteria

- [ ] All @nestjs/* packages upgraded to v11.1.9
- [ ] @nestjs/cli upgraded to v11.x
- [ ] @nestjs/testing upgraded to v11.x
- [ ] All backend tests pass
- [ ] TypeScript compilation succeeds
- [ ] Backend builds successfully
- [ ] WebSocket gateway functional
- [ ] No peer dependency warnings

## Technical Notes

### Packages to Upgrade

```bash
# Dependencies
pnpm add @nestjs/common@^11.1.9 @nestjs/core@^11.1.9 \
  @nestjs/platform-express@^11.1.9 @nestjs/platform-socket.io@^11.1.9 \
  @nestjs/websockets@^11.1.9 @nestjs/jwt@^11.0.1 \
  @nestjs/passport@^11.0.5 @nestjs/schedule@^6.0.1 \
  --filter=@socio/backend

# Dev Dependencies
pnpm add -D @nestjs/cli@^11.1.9 @nestjs/testing@^11.1.9 \
  --filter=@socio/backend
```

### Breaking Changes to Address

1. **Node.js v20+ required** - Verify CI and runtime environments
2. **Lifecycle hooks order reversed** - Test graceful shutdown
3. **Reflector API changes** - Return type now T | undefined
4. **Express v5 default** - Verify route matching unchanged

### Migration Guide Reference

- https://docs.nestjs.com/migration-guide
- https://trilon.io/blog/announcing-nestjs-11-whats-new

## Implementation Notes

Closed Dependabot PRs: #11, #13, #20, #21, #23

## Related

- Parent Epic: E01-dependency-upgrades
- Blocks: None
- Blocked by: None
- PR: To be created

---

**AI Agent Prompt:**

```
Upgrade all NestJS packages to v11 in apps/backend:
1. Update all @nestjs/* packages in package.json
2. Run pnpm install
3. Run pnpm --filter @socio/backend typecheck
4. Run pnpm --filter @socio/backend build
5. Run pnpm --filter @socio/backend test
6. Fix any errors related to breaking changes
7. Test WebSocket gateway functionality
8. Create PR with comprehensive testing notes
```
